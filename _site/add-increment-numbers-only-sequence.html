<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Biologist's bioinformatics notes</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="/js/jquery.min.js"></script>
  <script src="/js/bootstrap.min.js"></script>
  <link href="/css/bootstrap.min.css" rel="stylesheet" type="text/css">
  <link href="/css/theme.css" rel="stylesheet" type="text/css">
  <link href="/css/syntax.css" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
  <meta name="google-site-verification" content="fhL4tu7YrFAnIGAUl7DqfxgyLuyY6vE5h8o6fUwzoJM" />
</head>

<body>
  <nav class="navbar-fixed-top bg-primary">
    <span class="navbar-brand">Bioinformatics notes from a biologist</span>
    <ul class="nav navbar-nav">
      <li class="active"><a href="/"><i class="fas fa-home fa-2x"></i> Home</a></li>
      <li class="active"><a href="/archive.html"><i class="fas fa-archive fa-2x"></i> Archive</a></li>
    </ul>
  </nav>
</body>


<div class="container-fluid">
    <div class="row">
        <div class="col-md-3 hidden-xs">
            <div class=well>
  <div class="sidebar">
    09 August 2021
  </div>
  <div class="sidebar">
    <h1>Recent Posts</h1>
    <ul>
        
          <li><a href="/split_fasta_by_header_regex">Split fasta file into multiple files based on partial headers</a></li>
        
          <li><a href="/add_filenames_to_all_the_columns_in_bulk">Append file name at the end of each column for all CSV files</a></li>
        
          <li><a href="/add_duplicate_count_to_headers">Add count to duplicated IDs in fasta file</a></li>
        
          <li><a href="/remove_bases">Remove bases in between the sequences</a></li>
        
          <li><a href="/retain_unique_values">Retain only unique values in the data</a></li>
        
    </ul>
  </div>
  <div class="sidebar">
    <h1>Links</h1>
<ul>
  <li><a target="_blank" rel="noopener noreferrer" href="https://www.linkedin.com/in/svsk/">Linkedin</a></li>
  <li><a target="_blank" rel="noopener noreferrer" href="https://www.github.com/svsuresh">Github</a></li>
</ul>

  </div>
</div>
        </div>
        <div class="col-md-9">
          <div class="article">
            <div class="well">
                <h1><a href="/add-increment-numbers-only-sequence">Jul 6, 2018 - Add increment numbers to fasta  headers using nl</a></h1>
            <div class="post-content">
            <div dir="ltr" style="text-align: left;" trbidi="on">
Fasta is a sequence storage format with ID in first row and sequence (string) in the second row. Row with ID will have "&gt;" at the start.&nbsp; One of the request is to append increasing number of sequence numbers to the IDs. This is a trivial task if one simply have to append the numbers at the end of header. But user wants it immediately after sequence ID. For eg. if sequence ID line is "&gt;seq1 genus sp", user wants "&gt;seq1_0001 genus sp" for very first one. There are several ways to do it. Let us do it with "nl" function in ubuntu. nl numbers lines and is part of basic utils that come with most of the GNU-linux distros. Let us look at the input and expect output.<br />
input:<br />
======================================= <br />
$ cat test.fas<br />
&gt;seq1 genus sp<br />
acacaca<br />
&gt;seq2 genus sp<br />
acacacg<br />
&gt;seq3 genus sp<br />
acacact<br />
=======================================<br />
Expected output:<br />
=======================================<br />
&gt;seq1_000001 genus sp<br />
acacaca<br />
&gt;seq2_000002 genus sp<br />
acacacg<br />
&gt;seq3_000003 genus sp<br />
acacact<br />
=======================================<br />
code:<br />
=======================================<br />
$ nl -nrz -bp"&gt;" test.fas | sed '/&gt;/ s/\([0-9]\+\).*\(&gt;\w\+[0-9]\)\(.*\)/\2_\1\3/g;s/^\s\+//g'<br />
=======================================<br />
<div style="text-align: justify;">
nl - number lines </div>
<div style="text-align: justify;">
-n - number</div>
<div style="text-align: justify;">
-rz - right justified with 0s</div>
<div style="text-align: justify;">
-bp - number only those lines with pattern "&gt;"</div>
<div style="text-align: justify;">
Now this would add line numbers only at the start. We need to move it to appropriate place using patterns in sed. </div>
<div style="text-align: justify;">
</div>
<div style="text-align: justify;">
</div>
<br />
<br />
<br /></div>

            </div>
          </div>
          <div class="pagination">
              
                <a class="btn btn-default" href="/extract-columns-using-r-and-shell-from" class="next">Newer Post</a>
              
              
                <a class="btn btn-default" href="/lookaround-example-in-bash" class="previous">Older Post</a>
              
          </div>
        </div>
    </div>
</div>

<body>
<html>	
<div class="container-fluid">
    <div class="row-fluid">
        <div class="span12 footer navbar-inverse navbar-fixed-bottom">
            <p class="copyright">&copy;2021 Biologist's bioinformatics notes. Powered by <a href="http://jekyllrb.com">Jekyll</a>, theme by <a href="https://github.com/scotte/jekyll-clean">Scott Emmons</a>
            under
            <a href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution</a></p>
        </div>
    </div>
</div>

</body>
</html>

