<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Biologist's bioinformatics notes</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="/js/jquery.min.js"></script>
  <script src="/js/bootstrap.min.js"></script>
  <link href="/css/bootstrap.min.css" rel="stylesheet" type="text/css">
  <link href="/css/theme.css" rel="stylesheet" type="text/css">
  <link href="/css/syntax.css" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
  <meta name="google-site-verification" content="fhL4tu7YrFAnIGAUl7DqfxgyLuyY6vE5h8o6fUwzoJM" />
</head>

<body>
  <nav class="navbar-fixed-top bg-primary">
    <span class="navbar-brand">Bioinformatics notes from a biologist</span>
    <ul class="nav navbar-nav">
      <li class="active"><a href="/"><i class="fas fa-home fa-2x"></i> Home</a></li>
      <li class="active"><a href="/archive.html"><i class="fas fa-archive fa-2x"></i> Archive</a></li>
    </ul>
  </nav>
</body>


<div class="container-fluid">
    <div class="row">
        <div class="col-md-3 hidden-xs">
            <div class=well>
  <div class="sidebar">
    09 August 2021
  </div>
  <div class="sidebar">
    <h1>Recent Posts</h1>
    <ul>
        
          <li><a href="/split_fasta_by_header_regex">Split fasta file into multiple files based on partial headers</a></li>
        
          <li><a href="/add_filenames_to_all_the_columns_in_bulk">Append file name at the end of each column for all CSV files</a></li>
        
          <li><a href="/add_duplicate_count_to_headers">Add count to duplicated IDs in fasta file</a></li>
        
          <li><a href="/remove_bases">Remove bases in between the sequences</a></li>
        
          <li><a href="/retain_unique_values">Retain only unique values in the data</a></li>
        
    </ul>
  </div>
  <div class="sidebar">
    <h1>Links</h1>
<ul>
  <li><a target="_blank" rel="noopener noreferrer" href="https://www.linkedin.com/in/svsk/">Linkedin</a></li>
  <li><a target="_blank" rel="noopener noreferrer" href="https://www.github.com/svsuresh">Github</a></li>
</ul>

  </div>
</div>
        </div>
        <div class="col-md-9">
          <div class="article">
            <div class="well">
                <h1><a href="/glimma-error-second-argument-should">Jan 27, 2020 - glimma error: Second argument should contain the first.</a></h1>
            <div class="post-content">
            <div style="text-align: justify;">
<a href="https://bioconductor.org/packages/release/bioc/html/Glimma.html">Glimma</a> package&nbsp; is an interactive visualization package for RNAseq data, in general. However, one can visualize any numeric data that follows required data format. Some times, user can run into an error like this: "Warning: Error in checkThat: Second argument should contain the first". This error might be due to several issues as I am unaware of the code. However, one of the fixes is furnished below with example.&nbsp;</div>
<div style="text-align: justify;">
<br /></div>
<div style="text-align: justify;">
Test&nbsp; expression data can be downloaded from <a href="https://drive.google.com/open?id=1YyiZlnzM5M4tdkXyr0lUw5AkmC-pHFGVC3Nd1XJ-G9c">here</a> (taken from one of the Biostar posts). It is a plain text file (tab separated) as follows:</div>
<div style="text-align: justify;">
<br /></div>
<div style="text-align: justify;">
=========================================== </div>
<div style="text-align: justify;">
symbol&nbsp;&nbsp;&nbsp; genes&nbsp;&nbsp;&nbsp; logFC&nbsp;&nbsp;&nbsp; logCPM&nbsp;&nbsp;&nbsp; LR&nbsp;&nbsp;&nbsp; PValue&nbsp;&nbsp;&nbsp; FDR&nbsp;&nbsp;&nbsp;&nbsp;</div>
<div style="text-align: justify;">
===========================================<br />
ENSG00000018625&nbsp;&nbsp;&nbsp; CXorf56&nbsp;&nbsp;&nbsp; 4.731732&nbsp;&nbsp;&nbsp; 7.700889&nbsp;&nbsp;&nbsp; 21.57148&nbsp;&nbsp;&nbsp; 3.408840e-06&nbsp;&nbsp;&nbsp; 0.005551464&nbsp;&nbsp;&nbsp; <br />
ENSG00000065534&nbsp;&nbsp;&nbsp; SPEN&nbsp;&nbsp;&nbsp; 4.131256&nbsp;&nbsp;&nbsp; 12.597048&nbsp;&nbsp;&nbsp; 19.89395&nbsp;&nbsp;&nbsp; 8.185875e-06&nbsp;&nbsp;&nbsp; 0.005551464&nbsp;&nbsp;&nbsp; <br />
ENSG00000007933&nbsp;&nbsp;&nbsp; DNAJC11&nbsp;&nbsp;&nbsp; 5.340935&nbsp;&nbsp;&nbsp; 5.797704&nbsp;&nbsp;&nbsp; 19.28277&nbsp;&nbsp;&nbsp; 1.127190e-05&nbsp;&nbsp;&nbsp; 0.005551464&nbsp;&nbsp;&nbsp; <br />
ENSG00000091986&nbsp;&nbsp;&nbsp; CCDC80&nbsp;&nbsp;&nbsp; 3.829369&nbsp;&nbsp;&nbsp; 11.839320&nbsp;&nbsp;&nbsp; 18.55905&nbsp;&nbsp;&nbsp; 1.647217e-05&nbsp;&nbsp;&nbsp; 0.005551464&nbsp;&nbsp;&nbsp; <br />
ENSG00000022267&nbsp;&nbsp;&nbsp; C8B&nbsp;&nbsp;&nbsp; 3.820883&nbsp;&nbsp;&nbsp; 11.532498&nbsp;&nbsp;&nbsp; 18.43854&nbsp;&nbsp;&nbsp; 1.754731e-05&nbsp;&nbsp;&nbsp; 0.005551464&nbsp;&nbsp;&nbsp; <br />
ENSG00000007908&nbsp;&nbsp;&nbsp; TEAD3&nbsp;&nbsp;&nbsp; 5.402253&nbsp;&nbsp;&nbsp; 6.162232&nbsp;&nbsp;&nbsp; 18.41020&nbsp;&nbsp;&nbsp; 1.781025e-05&nbsp;&nbsp;&nbsp; 0.005551464 </div>
<div style="text-align: justify;">
&nbsp;============================================</div>
<div style="text-align: justify;">
<br /></div>
<div style="text-align: justify;">
Please note that this is a dummy data, not real data AFAIK.&nbsp; Let us load this run the following code to load and prune the data:</div>
<div style="text-align: justify;">
==========================================</div>
<div style="text-align: justify;">
# Loads the library </div>
<div style="text-align: justify;">
$ library(Glimma)</div>
<div style="text-align: justify;">
# Loads the data into a dataframe<br />
$ df=read.csv("test_glimma.txt", sep="\t", strip.white = T, stringsAsFactors = F)<br />
df</div>
<div style="text-align: justify;">
# Convert first column to row names of the dataframe<br />
$ row.names(df)=df[,1]</div>
<div style="text-align: justify;">
# Remove the first column<br />
$ df=df[,-1]</div>
<div style="text-align: justify;">
==========================================</div>
<div style="text-align: justify;">
Now let us execute the code for interactive html page:</div>
<div style="text-align: justify;">
==========================================</div>
<div style="text-align: justify;">
$ glXYPlot(df$logFC, -log10(df$FDR), xlab="logFC",ylab="-log(FDR)",anno=df$genes)</div>
<div style="text-align: justify;">
===========================================</div>
<div style="text-align: justify;">
Now this would throw following error: "Error in checkThat(side.main, isIn(display.columns)) : &nbsp; Second argument should contain the first. "</div>
<div style="text-align: justify;">
</div>
<div style="text-align: justify;">
Now this error has nothing to with the data frame, as I understand. This error is due to lack of another data frame that "anno" function needs and also missing, mandatory column name.&nbsp;</div>
<div style="text-align: justify;">
<br /></div>
<div style="text-align: justify;">
Way to address this issue is to create a data frame with the same data as above by removing all the expression data and keeping only gene names under "GeneID" column and keeping the row names same. Data frame should have same number of rows. Let us create a new data frame. Please compare with the original data frame (df).</div>
<div style="text-align: justify;">
============================================== </div>
<div style="text-align: justify;">
$ ga=data.frame(GeneID=df[,1], row.names=row.names(df))</div>
<div style="text-align: justify;">
==============================================</div>
<div style="text-align: justify;">
Now execute the code as follows:</div>
<div style="text-align: justify;">
==============================================</div>
<div style="text-align: justify;">
$ glXYPlot(df$logFC, -log10(df$FDR), xlab="logFC",ylab="-log(FDR)",anno=ga)<br />
&nbsp;==============================================</div>
<div style="text-align: justify;">
This would produce interactive html plot as shown below in image:</div>
<div style="text-align: justify;">
<div class="separator" style="clear: both; text-align: center;">
<a href="https://1.bp.blogspot.com/-27kZDkpDcSQ/Xi6NrGynOmI/AAAAAAAABRI/s_KZrFeYRtgFCja2PzbluG9KVOyq5kJSwCLcBGAsYHQ/s1600/Screenshot.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="828" data-original-width="1600" height="331" src="https://1.bp.blogspot.com/-27kZDkpDcSQ/Xi6NrGynOmI/AAAAAAAABRI/s_KZrFeYRtgFCja2PzbluG9KVOyq5kJSwCLcBGAsYHQ/s640/Screenshot.png" width="640" /></a></div>
<span id="goog_35377405"></span><span id="goog_35377406"></span><br /></div>
<div style="text-align: justify;">
<br /></div>
<div style="text-align: justify;">
</div>
<div style="text-align: justify;">
</div>
<div style="text-align: justify;">
</div>
<div style="text-align: justify;">
</div>
<div style="text-align: justify;">
Note:<br />
<ol>
<li>In Firefox (v 72), at first html table would look empty. Sort the Gene ID column, all the values appear.</li>
<li>To use the status function, you need to convert the boolean filter to numeric values (eg. status=as.numeric(df$FDR &lt;= 0.05)). </li>
</ol>
</div>

            </div>
          </div>
          <div class="pagination">
              
                <a class="btn btn-default" href="/merge-fastq-files-from-multiple" class="next">Newer Post</a>
              
              
                <a class="btn btn-default" href="/install-fastq-validator" class="previous">Older Post</a>
              
          </div>
        </div>
    </div>
</div>

<body>
<html>	
<div class="container-fluid">
    <div class="row-fluid">
        <div class="span12 footer navbar-inverse navbar-fixed-bottom">
            <p class="copyright">&copy;2021 Biologist's bioinformatics notes. Powered by <a href="http://jekyllrb.com">Jekyll</a>, theme by <a href="https://github.com/scotte/jekyll-clean">Scott Emmons</a>
            under
            <a href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution</a></p>
        </div>
    </div>
</div>

</body>
</html>

