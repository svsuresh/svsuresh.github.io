<p style="text-align: justify;">Sometimes, established tools drive us nuts. Following is an example. I have a vcf that is not sorted. Download it from <a href="https://drive.google.com/file/d/1AmBQOlt2sLn68Dfduv-y50S5_0aSQKfd/view?usp=sharing">here</a> (bgzipped, please un-gzip for the use) .Now let us follow the standard procedure to index this unsorted file.</p><ol style="text-align: justify;"><li>bgzip the file</li><li>Use tabix to index the file.&nbsp;</li></ol><p style="text-align: justify;">Now you would get following error:</p><p style="text-align: justify;">========================================</p><p style="text-align: justify;">$ tabix -p vcf ref.vcf.gz <br />[ti_index_core] the file out of order at line 59</p><p style="text-align: justify;">==========================================</p><p style="text-align: justify;">Since VCF is not sorted, tabix is throwing this error. Next logical step would be to use bcftools (I am using bcftools 1.10.2) to sort the vcf using "sort" function. Now run bcftools to sort the vcf. Following error you would get:</p><p style="text-align: justify;">=============================================================== <br /></p><p style="text-align: justify;">$ bcftools sort ref.vcf.gz&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;<br />Writing to /tmp/bcftools-sort.RNcNFP<br />[W::vcf_parse] Contig '1' is not defined in the header. (Quick workaround: index the file with tabix.)<br />Error encountered while parsing the input at 1:207684192<br />Cleaning<br />==============================================================</p><p style="text-align: justify;">Where should user go now? Tabix fails because vcf is not sorted and bcftools fails that chromosome number is not defined in header and fails to sort because of that. In addition to failing, it is suggesting user to use a tool that fails because of sorting.&nbsp;</p><p style="text-align: justify;">Fortunately, vcftools comes to the rescue. <br />===========================<br />$ vcf-sort ref.vcf.gz<br />===========================</p><p style="text-align: justify;">This populates vcf that can be used for indexing and tabix works as intended now, as the vcf is sorted. <br /></p>